---
title: "Séance 1: Introduction à la programmation scientifique"
author: "Dominique Gravel"
date: "Hiver 2023"
output:
  xaringan::moon_reader:
    css: [default, ../assets/bio109.css, "hygge"]
    lib_dir: assets
    seal: false
    nature:
      highlightStyle: monokai
      highlightLines: true
      countIncrementalSlides: false
      beforeInit: "../macros.js"
---

class: title-slide, middle

<style type="text/css">
  .title-slide {
    background-image: url('../assets/img/bg.jpg');
    background-color: #23373B;
    background-size: contain;
    border: 0px;
    background-position: 600px 0;
    line-height: 1;
  }
</style>

# Séance 1

<hr width="65%" align="left" size="0.3" color="orange"></hr>

## Introduction à la programmation scientifique

<hr width="65%" align="left" size="0.3" color="orange" style="margin-bottom:40px;" alt="@Martin Sanchez"></hr>

.instructors[
  **BIO109** - Victor Cameron
]

<img src="../assets/img/logo.png" width="24%" style="margin-top:20px;"></img>


---

# Introduction

<div style='text-align:center;'>
<img src="assets/img/intro/darwin.jpg" height="500px"></img>
</div>

---

# Introduction

<div style='text-align:center;'>
<img src="assets/img/intro/jane_goodall.jpg" height="500px"></img>
</div>

---

# Introduction
<div style='text-align:center;'>
<img src="assets/img/intro/biologist.jpg" height="500px"></img>
</div>

---

# Introduction

La programmation est un outil indispensable au biologiste 2.0, elle permet:

- Tâches **répétitives et/ou complexes** (p.ex. nettoyer, explorer et traiter de larges quantités de données)
- Faire des **analyses statistiques avancées** (p. ex. tests par permutations, statistiques bayésiennes)
- Créer des visualisations et des outils interactifs pour **communiquer et sensibiliser** efficacement
- Résoudre des **problèmes complexes** (p.ex. le suivi de la biodiversité, la modélisation de la dynamique des populations, la projection d'aires de distribution)

---

# Enseignant

## Victor Cameron
- victor.cameron@usherbrooke.ca
- D8-0012

## Gabriel Bergeron (assistant)
- gabriel.bergeron3@usherbrooke.ca
- D8-0022

## Benjamin Mercier (assistant)
- benjamin.b.mercier@usherbrooke.ca
- D8-0022

Pour les questions d'intérêt général, vous pouvez utiliser le forum de discussion sur Moodle.

---

# Biodiversité Québec

<div style='text-align:center;'>
<img src="assets/img/intro/inventaires.png" height="500px"></img>
</div>

---

# Biodiversité Québec

<div style='text-align:center;'>
<img src="assets/img/intro/portail.png" height="500px"></img>
</div>

---

# Biodiversité Québec

<div style='text-align:center;'>
<img src="assets/img/intro/indicateurs.png" height="500px"></img>
</div>

---

# La programmation en science

## Retour sur le forum

Attentes pour le cours
- Interagir avec des larges quantités de données

Utilisation de la programmation
- Traiter de larges quantités de données
- Application à d'autres fins que la recherche

Apport de la programmation à la biologie
- Aide et accélère le traitement des données à l'avantage de leur utilisation

---

# La programmation en science

.pull-left[
## Avantages

- Gain de temps
- Limiter les erreurs
- Formaliser les opérations
- Archiver, reproduire et partager
- Tâches intensives (e.g. en génomique)
]


.pull-right[
## Capacité de calcul
<img src="assets/img/intro/moores.png" width="100%"></img>
<span style="font-size:small;text-transform:uppercase;text-align:right;">
</span>
]

---

# La programmation et les sciences des données

<img src="assets/img/intro/covid.png" align="center" width="80%"></img>

---

# La programmation en science

.pull-left[
## Inconvénients

- L'erreur est avant tout humaine, avant d'être informatique
- La courbe apprentissage peut être difficile
]

.pull-right[
<img src="assets/img/intro/geek_mode.jpg" width="100%"></img>
]

---

# Instructions

- Présence en classe
- Un ordinateur portable
- Matériel du cours : https://github.com/EcoNumUdS/BIO109 et Moodle
- 3h de cours - 6h de travail personnel
- Lire les présentations avant le cours
- Faire les exercices
- Ressources additionnelles : R Cheat Sheet, R pour les débutants, exercies supplémentaires et matériel sur Moodle.

---

# Objectif général

Au terme de ce cours, l'étudiant sera en mesure de conceptualiser un problème qui requiert de la programmation scientifique et de réaliser des tâches courantes de programmation.

---

# Objectifs spécifiques

1. Conceptualiser un problème au moyen de pseudo-code;
2. Manipuler des données;
3. Rédiger des fonctions;
4. Programmer des algorithmes afin de réaliser des tâches complexes,
    incluant des boucles et des énoncés conditionnels;
5. Réaliser des simulations stochastiques.

---

# Ce que le cours n'est pas ...

1. Des recettes
2. Un catalogue de fonctions R
3. Un cours de statistiques

---

# Approche

Les connaissances requises pour la programmation scientifique sont
minimales, l'apprentissage porte davantage sur l'acquisition de
**compétences** et le développement de **capacités à la résolution de problèmes**.

Les séances sont constituées de courtes leçons magistrales sur des
notions de bases de programmation, entre-coupées d'exercices spécifiques
destinés à pratiquer les éléments enseignés. Les séances se conclueront
sur la réalisation d'un exercice intégrateur à compléter à la maison.

L'ensemble du matériel du cours sera disponible sur un dépôt Git à l'adresse :
https://github.com/EcoNumUdS/BIO109.git

---

# Évaluation

L'évaluation porte sur la participation (18%) et sur un travail de session (82%). Un exercice simple sera présenté à la fin des séances 1-3 et <b>chaque étudiant</b> devra remettre la solution de l'exercice sur Moodle sous forme de script <i>avant le début</i> de la séance suivante. <b>Les points sont attribués pour la participation.</b> Les solutions seront présentées au cours suivant.

- 3 exercies en classe (18%)
- Évaluation terminale : réalisation d'un projet de programmation <b>en équipe de 2</b> (82%)
  - Formatif : Pseudo-code à remettre avant la séance 5 (rétroaction retournée le 14 février)
  - Sommatif : Pseudo-code bonifié (22%) + programme (60%) à remettre le <b>21 février à 23h59</b>

Les évaluations sont à remettre sur Moodle.

---

# Évaluation terminale

La pénalité sera de 10% par jour de retard. Le rapport final sera évalué à
partir de

   1. le pseudo-code pour le projet de programmation,
   2. le respect des bonnes pratiques de programmation
   3. la réussite de l'exercice demandé.

Les étudiants devront remettre le script nécessaire à la
réalisation du projet.

---

# Introduction

<div style='text-align:center;'>
<img src="assets/img/intro/bioclim.png" height="500px"></img>
</div>

---

# Introduction

<div style='text-align:center;'>
<img src="assets/img/intro/mont_vertes.png" height="500px"></img>
</div>

---

# Introduction

<div style='text-align:center;'>
<img src="assets/img/intro/megantic.jpg" height="500px"></img>
</div>

---

# Introduction

<div style='text-align:center;'>
<img src="assets/img/intro/grille.jpg" height="250px"></img>
</div>

---

# Projet de session

## Question de recherche

À quelle vitesse se réalisera la migration de l'érable à sucre, et des espèces associées, au sein de la sapinière de montagne du massif des Montagnes vertes ?

---

# Le type de données

```{r}
arbres <- read.table(file = './donnees/arbres.txt', header = TRUE, sep=";")
head(arbres)
```

---

# Exercice 1

Ouvrir le fichier [arbres](./donnees/arbres.xlsx) avec Excel et calculer le nombre d'individus de chaque espèce pour le quadrat 1.

---

# Exercice 1: solution sur R

```{r}
arbres <- read.table(file = './donnees/arbres.txt', header = TRUE, sep=";")
quadrats <- table(arbres$id_bor,arbres$esp)
head(quadrats)
```

```{r, echo=FALSE}
write.table(quadrats, file="./donnees/quadrats.txt",sep=";",quote=TRUE)
```
---

# Exercice 2

Ouvrir le fichier [quadrats](./donnees/quadrats.xlsx) avec Excel et calculer la corrélation entre toutes les paires d'espèces.

Petit truc: sur Excel, la fonction pour calculer une corrélation est:

```bash
=COEFFICIENT.CORRELATION(données_1; données_2)
```

---

# Exercice 2: solution sur R

```{r,eval=FALSE}
quadrats <- read.table(file = './donnees/quadrats.txt', header = TRUE, sep= ";")
cor(quadrats)
```

```{r,eval=TRUE,echo=FALSE}
quadrats <- read.table(file = './donnees/quadrats.txt', header = TRUE, sep= ";")
round(cor(quadrats),6)
```

---

# Exercice 2: visualisation sur R

```{r,  fig.width= 6, fig.height= 6, fig.align='center'}
plot(quadrats)
```

---
class: inverse, center, middle

# Les langages de programmation
<hr width="65%" size="0.3" color="orange" style="margin-top:-20px;"></hr>

---

# Choix d'un langage : performance

<div style='text-align:center;'>
  <img src="assets/img/intro/performance.png" width="900px"></img>
</div>

---

# Choix d'un langage: 'débugging'

<div style='text-align:center;'>
  <img src="assets/img/intro/bug.jpg" width="600px"></img>
</div>

---

# Choix d'un langage : Statistiques et visualisation

Pour ce cours, nous utiliserons R :

- Langage de programmation open-source spécialisé en statistiques et en visualisation de données
- De nombreuses bibliothèques et packages disponibles pour effectuer diverses analyses statistiques
- Interface utilisateur RStudio pour faciliter l'utilisation de R
- Grand nombre de ressources en ligne et communauté active d'utilisateurs de R
- Création de sites Web et d'applications pour sensibiliser aux problèmes environnementaux et promouvoir des solutions durables.

> Langage utilisé dans le cadre de : biométrie, statistiques, méthodes en écologie computationnelle

---
class: inverse, middle, center

# Le Pseudo-Code
<hr width="65%" size="0.3" color="orange" style="margin-top:-20px;"></hr>

---

# Le `Pseudo-Code` et ses **algorithmes**


## Définitions

- *En programmation, le `pseudo-code` est une façon de formuler un <b>algorithme</b> sans référence à un langage de programmation en particulier.*

> - *Un <b>algorithme</b> est une suite d'actions qui sont réalisées dans un ordre précis par l'ordinateur. C'est une séquence d'étapes dans la résolution d'un problème.*

- Les principes de base seront les mêmes, d'un langage de programmation à l'autre. 

- Les éléments qui suivent résument les principales notions que vous aurez à maîtriser dans le cours. Il faut maîtriser ces notions *avant* de commencer la programmation sur R. 

---

# Le `Pseudo-Code`

## Exemple

```
PROGRAM DEMO
  FOR t IN 1:100
    n_t = n_t * lambda
    PRINT n_t
    IF n_t < 1
      BREAK
    ELSE
      CONTINUE
    END IF
  END FOR
```

Le programme `DEMO` fait croitre une population à un taux $\lambda$ et affiche à l'utilisateur si la population est éteinte ( $n_t<1$ ) ou vivante ( $n_t>1$ ).

---

# Le `Pseudo-Code`

## Exemple

```
PROGRAM DEMO
  FOR t IN 1:100 <------------- Opération itérative
    n_t = n_t * lambda
    PRINT n_t <---------------- Le programme affiche la valeur à l'écran
    IF n_t < 1 <--------------- Opération décisionnelle
      BREAK <------------------ Le programme arrête son éxécution
    ELSE
      CONTINUE <--------------- Le programme continue son éxécution
    END IF
  END FOR
```

Le programme `DEMO` fait croitre une population à un taux $\lambda$ et affiche à l'utilisateur si la population est éteinte ( $n_t<1$ ) ou vivante ( $n_t>1$ ).


---

# Les structures de base d'un algorithme

On retrouve 3 familles d'opérations:

1. Les opérations séquentielles
2. Les opérations itératives (`FOR`, `WHILE`)
3. Les opérations décisionnelles (`IF`, `IFELSE`)

Les opérations répétées peuvent être organisées sous forme de <b> Fonctions </b>.

---

# Avant-propos

Avant de décrire chacune des opérations d'un algorithme, certaines instructions sont communes:

- `READ`: le programme lit un fichier
- `WRITE`: le programme écrit un fichier
- `PRINT`: le programme écrit un message à l'écran pour l'utilisateur
- `BREAK`: le programme arrête son éxécution
- `CONTINUE`: le programme continue son éxécution
- `DEFINE`: définition d'une constante, d'un paramètre
- `SET` : initialise un objet

---

# Assignation des objets

Lorsque l'on crée un objet, il est initialement vide et il faut lui attribuer une valeur : 

```
a = 1
b = 2
```

On peut faire des opérations mathématiques sur ces objets : 

```
a * b
```

---

# Indexation des objets

Plus souvent, on travaille avec des tableaux de données :  

```
mat = matrix(c(1,2,3,4), nr = 2, nc = 2)
```

Cet objet a deux dimension, la première représentée par "i" et l'autre par "j". Sur R par exemple, on accède à la position définie par le couple i,j de la manière suivante : 

```
mat[i,j]
```

---

# Les types d'objets

Les objets en programmation sont définis en fonction de leur dimensionalité.

## Dimensionalité

- **Dimension 0** : Valeur unique
- **Dimension 1** : Vecteur
- **Dimension 2** : Matrice
- **Dimension 3** : ...

Bien qu'il n'y ait pas de limite à la dimension d'un objet en programmation,
pour le cours nous nous limiterons à des objets en deux dimensions
(c.à.d matrice)

---

# Dimension 0

Ces objets ne contiennent qu'une seule information

## Exemple

```
bobo = "toi"
coco = 2
dodo = -3
fofo = 456457.678
```

---

# Dimension 1

Ces objets contiennent un série d'information. Chaque valeur
a une position dans le vecteur, laquelle peut être accédée.

## Exemple

```
lettre = ["A" "R" "C" "D" "A"]
lettre[3]
# "C"
```

---

# Dimension 2

Ayant deux dimensions, ces objets présentent les données sous forme de matrices et ont des lignes et des colonnes. Pour accéder à une valeur dans une matrice il faut donner la position de la <b>ligne</b> en premier suivit de la position de la <b>colonne</b>.

## Exemple

```
lettreTab = ["A" "R" "C"
             "D" "A" "T"
             "R" "A" "Q"]

lettreTab[2, 1]
# "D"
```

---

# Les opérations séquentielles

## Exemple: Calculer l'aire d'un rectangle

```
PROGRAM REC_AIRE
  READ hauteur
  READ largeur
  WRITE hauteur * largeur
```

Chaque opération est effectuée l'une après l'autre dans un ordre déterminé.

---

# Exercice

```
PROGRAM AIRE_CERCLE
  DEFINE pi <- 3.1416
  DEFINE d <- {1, 2, 3, 4, 5}
  DEFINE index <- 2
  CALCUL aire <- pi*(d[index]/2)*(d[index]/2)
  WRITE aire
```

Quel est le résultat de ce calcul ?

---

# Les opérations itératives

La boucle est une séquence de base utilisée par tous les langages de programmation. 

Elle permet de répéter une opération un grand nombre de fois automatiquement. 

La boucle est définie par un point de départ, un point de d'arrivée et la séquence des opérations à réaliser à chaque itération de la boucle. 

Un indice permet de suivre la position dans la boucle.

---

# Les opérations itératives

## Exemple avec `FOR`: Croissance exponentielle

```
PROGRAM DEMO
  DEFINE lambda = 1.1
  DEFINE n_t = 1
  FOR etape IN 1:100
    n_t = n_t * lambda
  END FOR
  WRITE n_t
```

La population va croître pendant 100 pas de temps.

---

# Exercice

```
PROGRAM FACTORIELLE
  DEFINE depart = 1
  DEFINE fin = 5
  x = 1
  FOR etape in depart:fin
    x = x*etape
  WRITE x
```

Quelle valeur prendra x au terme de l'exécution du programme ? 

---

# Les opérations itératives et l'indexation

## Exemple avec `FOR`: Croissance exponentielle

```
PROGRAM DEMO
  SET resultat
  DEFINE lambda = 1.1
  FOR etape IN 1:100
    resultat[etape] = resultat[etape-1] * lambda
  END FOR
  WRITE resultat
```

Quel sera le contenu de 'resultat' ?

---

# Les opérations décisionnelles

Souvent un programme repose sur la réalisation d'une décision basée sur le résultat d'un calcul ou bien un paramètre défini par l'utilisateur. 

Les décisions sont binaires (oui/non, vrai/faux), mais plusieurs choix peuvent se combiner pour faire une décision entre plus de deux choix.

---

# Les opérations décisionnelles

## Exemple avec `IF`: quelques tests sur $\lambda$

```
PROGRAM DEMO
  IF lambda > 1
    PRINT "La population est croissante"
  ELSE lambda < 1
    PRINT "La population est décroissante"
  ENDIF
```

Et si le taux de croissance est nul?

---

# Les opérations décisionnelles

```
PROGRAM DEMO
  IF lambda > 1
    PRINT "La population est croissante"
  IF ELSE lambda < 1
    PRINT "La population est décroissante"
  ELSE
    PRINT "Absence de croissance"
  ENDIF
```

Avec la clause `ELSE`, la croissance est nulle

---

# Exemple : identifier un arbre

Écrire le pseudo code qui permet de déterminer quelle est l'espèce parmi l'érable à sucre, le bouleau jaune, le sapin baumier et le mélèze laricin sachant si ces arbres gardent leurs feuilles en hiver, si ils ont des aiguilles et si ils ont des samarres. 

---

# Exemple : identifier un arbre

```
PROGRAM ESPECE
  READ hiver
  READ feuilles
  READ graines

  IF(hiver == non) 
    IF(feuilles == aiguilles) espece = meleze
      IF(graines == samarres) espece = erable
        ELSE espece = bouleau
    ELSE espece = sapin
  WRITE espece
```

Notons l'utilisation du '==' pour tester s'il y a égalité.

---

# Les fonctions

Elles permettent de répéter rapidement des opérations, sous des conditions définies lorsqu'on les appelle. Ces conditions sont nommées des "arguments". 

```
FONCTION AIRE_CERCLE(rayon, pi)
  {
    aire = pi*rayon*rayon
    RETURN aire
  }
  
```

---

# Les fonctions

Le résultat de la fonction changera si on change les arguments.


```
  AIRE_CERCLE(rayon = 2, pi = 3.1416)

```

Ne donnera pas le même résultat que 

```
  AIRE_CERCLE(rayon = 1, pi = 3.1416)

```

---

# Les règles du `pseudo-code`

## A garder en mémoire

1. N'écrivez qu'une seule instruction par ligne de pseudo-code.
2. Écrivez en lettres majuscules le verbe de chaque opération principale (la fonction utilisée)
3. Soyez explicite en nommant les opérations et les variables.
4. Soyez le plus détaillé possible (c.à.d les plus petites étapes possibles)
5. Utilisez des structures de langages de programmation connues (c.à.d `FOR`, `IF`, etc.)
6. Délimitez les étapes en formant des blocs d'instructions par l'utilisation de l'indentation.

<b> Ces règles sont générales, peu importe le langage de programmation utilisé. </b>

---
class: inverse, middle, center

# Les bonnes pratiques en programmation scientifique
<hr width="65%" size="0.3" color="orange" style="margin-top:-20px;"></hr>


---

# Les 10 commandements de la programmation

> <b>1.</b> Commenter le code pour que d'autres puissent le lire, le comprendre et le partager

---

# Les 10 commandements de la programmation

> <b>1.</b> Commenter le code pour que d'autres puissent le lire, le comprendre et le partager

> <b>2.</b> Découper un script en blocs cohérents

---

# Les 10 commandements de la programmation

> <b>1.</b> Commenter le code pour que d'autres puissent le lire, le comprendre et le partager

> <b>2.</b> Découper un script en blocs cohérents

> <b>3.</b> Une seule opération par ligne

---

# Les 10 commandements de la programmation

> <b>1.</b> Commenter le code pour que d'autres puissent le lire, le comprendre et le partager

> <b>2.</b> Découper un script en blocs cohérents

> <b>3.</b> Une seule opération par ligne

> <b>4.</b> S'assurer qu'une instruction fonctionne avant de passer à l'étape suivante

---

# Les 10 commandements de la programmation

> <b>1.</b> Commenter le code pour que d'autres puissent le lire, le comprendre et le partager

> <b>2.</b> Découper un script en blocs cohérents

> <b>3.</b> Une seule opération par ligne

> <b>4.</b> S'assurer qu'une instruction fonctionne avant de passer à l'étape suivante

> <b>5.</b> Nommer adéquatement ses variables 

---

# Les 10 commandements de la programmation

> <b>1.</b> Commenter le code pour que d'autres puissent le lire, le comprendre et le partager

> <b>2.</b> Découper un script en blocs cohérents

> <b>3.</b> Une seule opération par ligne

> <b>4.</b> S'assurer qu'une instruction fonctionne avant de passer à l'étape suivante

> <b>5.</b> Nommer adéquatement ses variables 

> <b>6.</b> Un bon programmeur est paresseux. Les opérations répétées doivent être définies sous forme de fonctions

---

# Les 10 commandements de la programmation

> <b>1.</b> Commenter le code pour que d'autres puissent le lire, le comprendre et le partager

> <b>2.</b> Découper un script en blocs cohérents

> <b>3.</b> Une seule opération par ligne

> <b>4.</b> S'assurer qu'une instruction fonctionne avant de passer à l'étape suivante

> <b>5.</b> Nommer adéquatement ses variables 

> <b>6.</b> Un bon programmeur est paresseux. Les opérations répétées doivent être définies sous forme de fonctions

> <b>7.</b> La vie est trop courte, optimiser son code

---

# Les 10 commandements de la programmation

> <b>1.</b> Commenter le code pour que d'autres puissent le lire, le comprendre et le partager

> <b>2.</b> Découper un script en blocs cohérents

> <b>3.</b> Une seule opération par ligne

> <b>4.</b> S'assurer qu'une instruction fonctionne avant de passer à l'étape suivante

> <b>5.</b> Nommer adéquatement ses variables 

> <b>6.</b> Un bon programmeur est paresseux. Les opérations répétées doivent être définies sous forme de fonctions

> <b>7.</b> La vie est trop courte, optimiser son code

> <b>8.</b> S'assurer que le code soit reproductible par autrui

---

# Les 10 commandements de la programmation

> <b>9.</b> Contraindre les tirages au sort afin de le répéter

---

# Les 10 commandements de la programmation

> <b>9.</b> Contraindre les tirages au sort afin de le répéter

> <b>10.</b> Utiliser le contrôle de version afin de pouvoir revenir dans le passé

---
class: inverse, middle, center

# Installation de R et de RStudio
<hr width="65%" size="0.3" color="orange" style="margin-top:-20px;"></hr>

À faire pour la <b>prochaine séance</b>. 

Le guide d'installation se trouve sur la page Moodle
du cours sous la rubrique <b>Étape 1</b>. Le
débuggage se fera au prochain cours.

---
class: inverse, middle, center

# Exercice de la semaine
<hr width="65%" size="0.3" color="orange" style="margin-top:-20px;"></hr>

---

# Une situation qui peut arriver tous les jours

Écrivez un pseudo-code pour générer une liste de 20 nombres aléatoires compris entre 1 et 100, puis afficher la moyenne de ces nombres.

Prenez le temps de distinguer les étapes que vous réalisez lorsque vous générez les chiffres et lorsque vous en calculez la moyenne. Vous devez les écrire sous forme de pseudo-code.

<b>Note 1</b>: vous pouvez assumer que l'ordinateur peut produire un nombre alléatoire à l'aide de la commande `generate_random_number()`.

<b>Note 2</b>: vous pouvez assumer que l'ordinateur peut déterminer la longueur d'un vecteur à l'aide de la commande `length()`.
